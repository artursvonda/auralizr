/*! auralizr 2014-01-20 */
!function(){function a(a){var b=this;return this.userMediaSupport=!1,this.isMicEnabled=!1,this.irArray={},this.startRequest=!1,this.stream=null,this.delegate=a,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,this.convolver=this.audioContext.createConvolver(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia?(this.userMediaSupport=!0,void navigator.getUserMedia({audio:!0},function(a){b.isMicEnabled=!0,b.stream=a;var c=!0;if(b.delegate&&b.delegate.didGetUserStream&&b.delegate.didGetUserStream(a)===!1&&(c=!1),c){var d=b.audioContext.createMediaStreamSource(a);d.connect(b.convolver)}b.startRequest&&b.start()},function(){console.log("Error getting audio stream from getUserMedia")})):(console.log("Unfortunately, your browser doesn't support the getUserMedia API needed for this expiriment. Try using Chrome instead"),null)}a.prototype.getConvolver=function(){return this.convolver},a.prototype.load=function(a,b,c){var d=this,e=new XMLHttpRequest;e.open("GET",a,!0),e.responseType="arraybuffer",e.onload=function(){d.irArray[b]=d.audioContext.createBuffer(e.response,!1),c(b)},e.send()},a.prototype.isReady=function(a){return this.isMicEnabled&&this.irArray.hasOwnProperty(a)&&void 0!==this.irArray[a]},a.prototype.use=function(a){this.irArray.hasOwnProperty(a)&&void 0!==this.irArray[a]&&this.setBuffer(this.irArray[a])},a.prototype.start=function(){return this.startRequest=!0,this.isMicEnabled?null===this.convolver.buffer?void console.log("Couldn't start the auralizr. Buffer is not loaded"):(console.log("Starting auralizr"),this.convolver.connect(this.audioContext.destination),void(this.startRequest=!1)):void console.log("Couldn't start the auralizr. Mic is not enabled")},a.prototype.setBuffer=function(a){this.convolver.buffer=a},a.prototype.stop=function(){this.startRequest=!1,console.log("Stopping auralizr"),this.convolver.disconnect()},"undefined"==typeof module?window.auralizr=a:module.exports=a}();